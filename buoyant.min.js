/*
Copyright 2013-2015 CLEARWAVE DESIGNS, LLC

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
 
Author:        Adam Carson
Website:       http://clearwavedesigns.com
 
Name(s):       BuoyantJS
Version:       1.0.3.20150707
Slogan:        "Surface level coding."
Description:   BuoyantJS is an MVC two-way data-binding framework and DOM manipulation library.
*/

var $Buoyant=function(e,t){this.elems=e,this.selector=t};$Buoyant.prototype.addClass=function(e){if(""===e||" "===e)return this;for(var t=e.split(/[,\s]+/g),r=0,n=this.elems.length;n>r;r++)for(var s=0,o=t.length;o>s;s++)this.elems[r].className+=" "+t[s];return this},$Buoyant.prototype.attr=function(e,t){var r="";if(t){for(var n=0,s=this.elems.length;s>n;n++)this.elems[n].setAttribute(e,t);return this}for(var n=0,s=this.elems.length;s>n;n++)r+=this.elems[n].getAttribute(e);return r},$Buoyant.prototype.child=function(e){for(var t=[],r=0,n=this.elems.length;n>r;r++)t[r]=this.elems[r].children[e];return new $Buoyant(t)},$Buoyant.prototype.children=function(){for(var e=[],t=0,r=this.elems.length;r>t;t++){var n=this.elems[t].parentElement.children;for(j=0,m=n.length;m>j;j++)e[j]=n[j]}return new $Buoyant(e)},$Buoyant.prototype.css=function(e,t,r){function n(e){for(var t=0,r=s.length;r>t;t++)s[t].style.cssText=e}var s=this.elems;if("string"==typeof e&&void 0===t)r?setTimeout(function(){n(e)},r):n(e);else if("object"==typeof e){var o=JSON.stringify(e).replace(/[\{\}"']*/g,"").replace(/,/g,";")+";";t?setTimeout(function(){n(o)},t):n(o)}else{var o=e+":"+t+";";r?setTimeout(function(){n(o)},r):n(o)}return this},$Buoyant.prototype.each=function(e){for(var t=0,r=this.elems.length;r>t;t++)this.elems[t].temp=e,this.elems[t].temp();return this},$Buoyant.prototype.empty=function(){for(var e=0,t=this.elems.length;t>e;e++)this.elems[e].innerHTML="";return this},$Buoyant.prototype.eq=function(e){return new $Buoyant([this.elems[e]])},$Buoyant.prototype.exists=function(){return this.elems.length>0?!0:!1},$Buoyant.prototype.fadeIn=function(e){function t(){1>o?(s.style.opacity=o,o+=a,setTimeout(function(){t()},30)):s.style.opacity=1}for(var r=0,n=this.elems.length;n>r;r++){this.elems[r].style.opacity=0,this.elems[r].style.display="block";var s=this.elems[r],o=0,a=1/e*30;t()}return this},$Buoyant.prototype.fadeOut=function(e){function t(){o>0?(s.style.opacity=o,o-=a,setTimeout(function(){t()},30)):(s.style.opacity=0,s.style.display="none")}for(var r=0,n=this.elems.length;n>r;r++){var s=this.elems[r],o=1,a=1/e*30;t()}return this},$Buoyant.prototype.find=function(e){return new $Buoyant(this.nodeListToArray(this.selector+" "+e))},$Buoyant.prototype.focus=function(){return this.elems[0].focus(),this},$Buoyant.prototype.hasClass=function(e){if(""===e||" "===e)return this;for(var t=!1,r=e.split(/[,\s]+/g),n=0,s=this.elems.length;s>n;n++)for(var o=0,a=r.length;a>o;o++){var i=new RegExp(r[o]);i.test(this.elems[n].className)&&(t=!0)}return t},$Buoyant.prototype.height=function(e){if(!e)return this.elems[0].offsetHeight;for(var t=0,r=this.elems.length;r>t;t++)this.elems[t].style.height=e;return this},$Buoyant.prototype.html=function(e){var t="";if(e){for(var r=0,n=this.elems.length;n>r;r++)this.elems[r].innerHTML=e;return this}for(var r=0,n=this.elems.length;n>r;r++)t+=this.elems[r].text;return t},$Buoyant.prototype.length=function(){return this.elems.length},$Buoyant.prototype.next=function(){for(var e=[],t=0,r=this.elems.length;r>t;t++)e[t]=this.elems[t].nextElementSibling;return new $Buoyant(e)},$Buoyant.prototype.nodeListToArray=function(e){for(var t=document.querySelectorAll(e),r=[],n=0,s=t.length;s>n;n++)r[n]=t[n];return r},$Buoyant.prototype.off=function(e,t,r){if(r){for(var n=String(r).replace(/\s/g,""),s=0,o=$.listenerCallbacksDelegatedFunctions.length;o>s;s++)if(String($.listenerCallbacksDelegatedFunctions[s]).replace(/\s/g,"")===n){for(var a=0,i=this.elems.length;i>a;a++)this.elems[a].removeEventListener(e,$.listenerCallbacksDelegated[s],!1);$.listenerCallbacksDelegated.splice(s,1),$.listenerCallbacksDelegatedFunctions.splice(s,1);break}}else for(var l=String(t),s=0,o=$.listenerCallbacks.length;o>s;s++)if(String($.listenerCallbacks[s])===l){for(var a=0,i=this.elems.length;i>a;a++)this.elems[a].removeEventListener(e,$.listenerCallbacks[s],!1);$.listenerCallbacks.splice(s,1);break}},$Buoyant.prototype.on=function(e,t,r){var n=this;if(r){$.listenerCallbacksDelegatedFunctions.push(r),$.listenerCallbacksDelegated.push(function(e){for(var s=n.nodeListToArray(n.selector+" "+t),o=0,a=s.length;a>o;o++)if(e.target===s[o])r.call(s[o],e);else{for(var i=e.target.parentElement;i&&s[o]!==i;)i=i.parentElement;i&&r.call(s[o],e)}});for(var s=0,o=this.elems.length;o>s;s++)this.elems[s].addEventListener(e,$.listenerCallbacksDelegated[$.listenerCallbacksDelegated.length-1],!1)}else{$.listenerCallbacks.push(t);for(var s=0,o=this.elems.length;o>s;s++)this.elems[s].addEventListener(e,$.listenerCallbacks[$.listenerCallbacks.length-1],!1)}},$Buoyant.prototype.parent=function(){for(var e=[],t=0,r=this.elems.length;r>t;t++)e[t]=this.elems[t].parentElement;return new $Buoyant(e)},$Buoyant.prototype.prev=function(){for(var e=[],t=0,r=this.elems.length;r>t;t++)e[t]=this.elems[t].previousElementSibling;return new $Buoyant(e)},$Buoyant.prototype.remove=function(){for(var e=0,t=this.elems.length;t>e;e++)this.elems[e].parentElement.removeChild(this.elems[e]);return this},$Buoyant.prototype.removeAttr=function(e){for(var t=0,r=this.elems.length;r>t;t++)this.elems[t].removeAttribute(e);return this},$Buoyant.prototype.removeClass=function(e){if(""===e||" "===e)return this;for(var t=e.split(/[,\s]+/g),r=0,n=this.elems.length;n>r;r++)for(var s=0,o=t.length;o>s;s++){var a=new RegExp("\\s*"+t[s],"g");this.elems[r].className=this.elems[r].className.replace(a,"")}return this},$Buoyant.prototype.selectedIndex=function(){for(var e=0,t=0,r=this.elems.length;r>t;t++)e+=this.elems[t].selectedIndex;return e},$Buoyant.prototype.siblings=function(){for(var e=[],t=0,r=0,n=this.elems.length;n>r;r++)for(var s=this.elems[r].parentElement.children,o=0,a=s.length;a>o;o++)s[o]!==this.elems[r]?e[o-t]=s[o]:t++;return new $Buoyant(e)},$Buoyant.prototype.text=function(e){var t="";if(e||0===e||""===e){for(var r=0,n=this.elems.length;n>r;r++)this.elems[r].textContent=e;return this}for(var r=0,n=this.elems.length;n>r;r++)t+=this.elems[r].textContent;return t},$Buoyant.prototype.toggleClass=function(e){for(var t=e.split(/[,\s]+/g),r=0,n=this.elems.length;n>r;r++)for(var s=0,o=t.length;o>s;s++){var a=new RegExp("\\s*"+t[s],"g");a.test(this.elems[r].className)?this.elems[r].className=this.elems[r].className.replace(a,""):this.elems[r].className+=" "+t[s]}return this},$Buoyant.prototype.unwrap=function(e){for(var t=this.nodeListToArray(e),r=0,n=this.elems.length;n>r;r++){var s=this.elems[r];do s=s.parentElement;while(s!==t[r]);var o=document.createDocumentFragment(),a=document.createElement("div");a.innerHTML=this.elems[r].outerHTML;for(var i=a.childNodes,l=[],h=0,c=i.length;c>h;h++)l[h]=a.childNodes[h];for(var h=0,c=l.length;c>h;h++)o.appendChild(l[h]);var u=s.parentElement;u.insertBefore(o,s),u.removeChild(s)}return this},$Buoyant.prototype.val=function(e){var t="";if(e||0===e||""===e){for(var r=0,n=this.elems.length;n>r;r++)this.elems[r].value=e;return this}for(var r=0,n=this.elems.length;n>r;r++)t+=this.elems[r].text||this.elems[r].value;return t},$Buoyant.prototype.width=function(e){if(!e)return this.elems[0].offsetWidth;for(var t=0,r=this.elems.length;r>t;t++)this.elems[t].style.width=e;return this},$Buoyant.prototype.wrap=function(e,t){for(var r=0,n=this.elems.length;n>r;r++){var s=document.createDocumentFragment(),o=document.createElement("div");o.innerHTML=e+this.elems[r].outerHTML+t;for(var a=o.childNodes,i=[],l=0,h=a.length;h>l;l++)i[l]=o.childNodes[l];for(var l=0,h=i.length;h>l;l++)s.appendChild(i[l]);var c=this.elems[r].parentElement;c.insertBefore(s,this.elems[r]),c.removeChild(this.elems[r])}return this};var $=function(e){var t=[];if(!e)return this;if("object"==typeof e)return t[0]=e,new $Buoyant(t,e);if("function"!=typeof e){for(var r=document.querySelectorAll(e),n=r.length,s=0;n>s;s++)t[s]=r[s];return new $Buoyant(t,e)}document.addEventListener("DOMContentLoaded",e)};$.ajax=function(e){var t=new XMLHttpRequest;if(!t)return e.hasOwnProperty("error")&&e.error("Could not establish HTTP request."),!1;t.onreadystatechange=function(){if(4===t.readyState){var r=t.responseText;"json"===e.dataType&&(r=JSON.parse(r)),200===t.status?e.hasOwnProperty("success")&&e.success(r):e.hasOwnProperty("error")&&e.error(r),e.hasOwnProperty("finally")&&e.finally(r)}};var r=function(){return e.hasOwnProperty("method")?e.method.toUpperCase():e.hasOwnProperty("type")?e.type.toUpperCase():"POST"}(),n=function(){return e.hasOwnProperty("action")?e.action:e.url}();if(t.open(r,n),e.hasOwnProperty("dataType"))switch(e.dataType=e.dataType.toLowerCase(),e.dataType){case"html":t.setRequestHeader("Content-Type","text/html;charset=UTF-8");break;case"json":t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.hasOwnProperty("data")&&(e.data=JSON.stringify(e.data));break;case"script":t.setRequestHeader("Content-Type","application/javascript;charset=UTF-8");break;case"xml":t.setRequestHeader("Content-Type","text/xml;charset=UTF-8");break;default:t.setRequestHeader("Content-Type","text/plain;charset=UTF-8")}else t.setRequestHeader("Content-Type","text/plain;charset=UTF-8");e.hasOwnProperty("data")?t.send(e.data):t.send()},$.listenerCallbacks=[],$.listenerCallbacksDelegated=[],$.listenerCallbacksDelegatedFunctions=[];var $$Buoyant=function(e){this.prefix="by",this.offlineSupport=!1,this.offline=!1,e&&(this.prefix=e.hasOwnProperty("prefix")?e.prefix:"by",this.offlineSupport=e.hasOwnProperty("offlineSupport")?e.offlineSupport:!1,this.offline=e.hasOwnProperty("offline")?e.offline:!1),function(){var e=document.createElement("style");e.textContent="["+this.prefix+"-cloak], ["+this.prefix+"-ready] { display: none !important; }",document.querySelector("head").appendChild(e)}(),this.viewSelector=document.querySelector("["+this.prefix+"-view]")};$$Buoyant.prototype.parseNodeList=function(e){for(var t=[],r=document.querySelectorAll(e),n=0,s=r.length;s>n;n++)t[n]=r[n];return t},$$Buoyant.prototype.parseListener=function(e){return e.replace(/(\s|\(|\))/g,"")},$$Buoyant.prototype.reset=function(){if(this.controllerUnbind(this.controllerName),this.resources[this.controllerName].hasOwnProperty("view"))if(this.resources[this.controllerName].hasOwnProperty("styles")){this.viewSelector.innerHTML="<style>"+this.resources[this.controllerName].styles+"</style>";var e=document.createDocumentFragment(),t=document.createElement("div");t.innerHTML=this.resources[this.controllerName].view,e.appendChild(t.childNodes[0]),this.viewSelector.appendChild(e)}else this.viewSelector.innerHTML=this.resources[this.controllerName].view;this.controllerBind(this.controllerName)},$$Buoyant.prototype.http=function(e){var t=new XMLHttpRequest;if(!t)return e.hasOwnProperty("error")&&e.error("Could not establish HTTP request."),!1;t.onreadystatechange=function(){if(4===t.readyState){var r=t.responseText;"json"===e.dataType&&(r=JSON.parse(r)),200===t.status?e.hasOwnProperty("success")&&e.success(r):e.hasOwnProperty("error")&&e.error(r),e.hasOwnProperty("finally")&&e.finally(r)}};var r=function(){return e.hasOwnProperty("method")?e.method.toUpperCase():e.hasOwnProperty("type")?e.type.toUpperCase():"POST"}(),n=function(){return e.hasOwnProperty("action")?e.action:e.url}();if(t.open(r,n),e.hasOwnProperty("dataType"))switch(e.dataType=e.dataType.toLowerCase(),e.dataType){case"html":t.setRequestHeader("Content-Type","text/html;charset=UTF-8");break;case"json":t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.hasOwnProperty("data")&&(e.data=JSON.stringify(e.data));break;case"script":t.setRequestHeader("Content-Type","application/javascript;charset=UTF-8");break;case"xml":t.setRequestHeader("Content-Type","text/xml;charset=UTF-8");break;default:t.setRequestHeader("Content-Type","text/plain;charset=UTF-8")}else t.setRequestHeader("Content-Type","text/plain;charset=UTF-8");e.hasOwnProperty("data")?t.send(e.data):t.send()},$$Buoyant.prototype.bindFromDev=function(e){for(var t=this.parseNodeList("["+this.prefix+'-controller="'+e+'"] ['+this.prefix+"-bind]"),r=0,n=t.length;n>r;r++)/(INPUT|TEXTAREA|PROGRESS)/i.test(t[r].nodeName)?t[r].value=this.$$[e][t[r].getAttribute(this.prefix+"-bind")]:t[r].textContent=this.$$[e][t[r].getAttribute(this.prefix+"-bind")]},$$Buoyant.prototype.bindFromUser=function(e,t){this.$$[e][t.getAttribute(this.prefix+"-bind")]=/(INPUT|TEXTAREA|PROGRESS)/i.test(t.nodeName)?t.value:t.textContent},$$Buoyant.prototype.resources={},$$Buoyant.prototype.route={},$$Buoyant.prototype.router=function(e,t){var r=this;if(this.controllerName&&this.$$.hasOwnProperty(this.controllerName)&&this.controllerUnbind(this.controllerName),t||(this.controllerName=e),this.resources.hasOwnProperty(e)){if(delete this.$$[e],this.$$[e]={},!t)if(this.resources[e].hasOwnProperty("styles")){this.viewSelector.innerHTML="<style>"+this.resources[e].styles+"</style>";var n=document.createDocumentFragment(),s=document.createElement("div");s.innerHTML=this.resources[e].view,n.appendChild(s.childNodes[0]),this.viewSelector.appendChild(n)}else this.viewSelector.innerHTML=this.resources[e].view;setTimeout(function(){r.controllerBind(e,r.resources[e].model)},10)}},$$Buoyant.prototype.routeInit=function(){var e=this,t=function(r){e.route.hasOwnProperty(r)?e.router(e.route[r]):setTimeout(function(){t(r)},100)},r=location.hash;if(!/#\!\//.test(window.location.href.toString())&&r);else if(/#\!\//.test(r)){var n=r.replace(/#\!/,"").replace(/\/$/,"");history.replaceState("","",n),t(n)}else t(location.pathname)},$$Buoyant.prototype.controllerName=void 0,$$Buoyant.prototype.controller=function(e,t){this.resources.hasOwnProperty(e)?this.resources[e].model=t:(this.resources[e]={},this.resources[e].model=t,this.router(e,!0))},$$Buoyant.prototype.controllerUnbind=function(){},$$Buoyant.prototype.controllerBind=function(e,t){try{var r=this,n=document.querySelector("["+this.prefix+'-controller="'+e+'"]');n.addEventListener("click",function(){r.bindFromUser(e,event.target)}),n.addEventListener("keyup",function(){r.bindFromUser(e,event.target)}),n.addEventListener("change",function(){r.bindFromUser(e,event.target)}),t&&t(this.$$[e],this.http.bind(this));for(var s=this.parseNodeList("["+this.prefix+'-controller="'+e+'"] ['+this.prefix+"-for]"),o=0,a=s.length;a>o;o++){var i=s[o].outerHTML,l=new RegExp(".*"+this.prefix+'\\-for\\="\\s*(\\w+)\\s+in\\s+(\\w+)[.\\s\\S]+'),h=i.replace(l,"$1BuoyantJS$2");l=new RegExp("\\s+"+this.prefix+'\\-cloak\\=?("{2})?',"g"),i=i.replace(l,"");for(var c=h.replace(/(\w+)BuoyantJS.+/,"$1"),u=h.replace(/\w+BuoyantJS(\w+)/,"$1"),p=this.$$[e][u].length,y=new RegExp("{{\\s*"+c+"\\.\\w+\\s*}}","g"),f=i.match(y),d=[],m=0,v=f.length;v>m;m++)d[m]=f[m].replace(/\{\{\s*\w+\.(\w+)\s*\}\}/,"$1");for(var g="",$="",m=0,v=p;v>m;m++){$=i;for(var w=0,T=f.length;T>w;w++){var B=new RegExp(f[w]);$=$.replace(B,this.$$[e][u][m][d[w]])}g+=$}var x=s[o].parentNode,C=document.createDocumentFragment(),b=document.createElement("div");b.innerHTML=g;for(var S=b.childNodes,O=[],m=0,v=S.length;v>m;m++)O[m]=b.childNodes[m];for(var m=0,v=O.length;v>m;m++)C.appendChild(O[m]);x.insertBefore(C,s[o]),x.removeChild(s[o])}this.bindFromDev(e);for(var P=this.parseNodeList("["+this.prefix+'-controller="'+e+'"] ['+this.prefix+"-click]"),o=0,a=P.length;a>o;o++)P[o].addEventListener("click",function(){r.$$[e][r.parseListener(this.getAttribute(r.prefix+"-click"))].call(this)},!1);for(var N=this.parseNodeList("["+this.prefix+'-controller="'+e+'"] ['+this.prefix+"-keyup]"),o=0,a=N.length;a>o;o++)N[o].addEventListener("keyup",function(){r.$$[e][r.parseListener(this.getAttribute(r.prefix+"-keyup"))].call(this)},!1);for(var L=this.parseNodeList("["+this.prefix+'-controller="'+e+'"] ['+this.prefix+"-change]"),o=0,a=L.length;a>o;o++)L[o].addEventListener("change",function(){r.$$[e][r.parseListener(this.getAttribute(r.prefix+"-change"))].call(this)},!1)}catch(E){console.log('BuoyantJS resource(s) are missing; or, names do not match across all associations for the "'+e+'" controller.')}},$$Buoyant.prototype.$$={},$$Buoyant.prototype.$$reset=function(){this.reset()},$$Buoyant.prototype.$$http=function(e){var t=this,r=new XMLHttpRequest;if(!r)return e.hasOwnProperty("error")&&e.error("Could not establish HTTP request."),!1;r.onreadystatechange=function(){if(4===r.readyState){var n=r.responseText;"json"===e.dataType&&(n=JSON.parse(n)),200===r.status?e.hasOwnProperty("success")&&e.success(n):e.hasOwnProperty("error")&&e.error(n),e.hasOwnProperty("finally")&&e.finally(n),t.reset()}};var n=function(){return e.hasOwnProperty("method")?e.method.toUpperCase():e.hasOwnProperty("type")?e.type.toUpperCase():"POST"}(),s=function(){return e.hasOwnProperty("action")?e.action:e.url}();if(r.open(n,s),e.hasOwnProperty("dataType"))switch(e.dataType=e.dataType.toLowerCase(),e.dataType){case"html":r.setRequestHeader("Content-Type","text/html;charset=UTF-8");break;case"json":r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.hasOwnProperty("data")&&(e.data=JSON.stringify(e.data));break;case"script":r.setRequestHeader("Content-Type","application/javascript;charset=UTF-8");break;case"xml":r.setRequestHeader("Content-Type","text/xml;charset=UTF-8");break;default:r.setRequestHeader("Content-Type","text/plain;charset=UTF-8")}else r.setRequestHeader("Content-Type","text/plain;charset=UTF-8");e.hasOwnProperty("data")?r.send(e.data):r.send()},$$Buoyant.prototype.$$routes=function(e){var t=this;if(this.offline&&localStorage.hasOwnProperty("BuoyantJS_resources"))this.route=JSON.parse(localStorage.getItem("BuoyantJS_route")),this.resources=JSON.parse(localStorage.getItem("BuoyantJS_resources"));else for(var r=0,n=e.length;n>r;r++)this.route[e[r].url]=e[r].controller,this.resources[e[r].controller]={};/Edge|Trident|MSIE/.test(navigator.userAgent)?addEventListener("hashchange",function(e){e.preventDefault(),t.routeInit()}):addEventListener("popstate",function(e){e.preventDefault(),t.routeInit()});var s=window.location.href.toString(),o=(/\/#\!/.test(s)?s.replace(/https?:\/\/.+\/#\!/,"").replace(/\/$/,""):"/",function(){t.routeInit();for(var e=t.parseNodeList("["+t.prefix+"-ready]"),r=0,n=e.length;n>r;r++)e[r].removeAttribute(t.prefix+"-ready");t.$$ready()});if(t.offline)o();else{for(var a=function(){i===l+c&&(t.offlineSupport&&(localStorage.setItem("BuoyantJS_route",JSON.stringify(t.route)),localStorage.setItem("BuoyantJS_resources",JSON.stringify(t.resources))),o())},i=function(){for(var t=e.length,r=0,n=e.length;n>r;r++)e[r].hasOwnProperty("styles")&&(Array.isArray(e[r].styles)?t+=e[r].styles.length:t++);return t}(),l=0,h=function(r){t.http({action:e[r].view,method:"POST",dataType:"HTML",success:function(n){t.resources[e[r].controller].view=n},error:function(){console.log("No view found for controller: "+e[r].controller+".")},"finally":function(){l++,a()}})},r=0;r<e.length;r++)h(r);for(var c=0,u=function(r,n){t.http({action:n||0===n?e[r].styles[n]:e[r].styles,method:"POST",dataType:"text",success:function(n){var s=t.resources[e[r].controller];s.styles?s.styles+=n:s.styles=""+n},error:function(){console.log("No style(s) found for controller: "+e[r].controller+".")},"finally":function(){c++,a()}})},r=0;r<e.length;r++)if(e[r].hasOwnProperty("styles"))if(Array.isArray(e[r].styles))for(var p=0,y=e[r].styles.length;y>p;p++)u(r,p);else u(r)}},$$Buoyant.prototype.$$ready=function(){};var buoyant=new $$Buoyant;
